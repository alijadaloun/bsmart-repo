---
import Layout from '~/layouts/PageLayout.astro';

import Hero from '~/components/widgets/Hero.astro';
import Features from '~/components/widgets/Features.astro';
import Features2 from '~/components/widgets/Features2.astro';
import Content from '~/components/widgets/Content.astro';
import Stats from '~/components/widgets/Stats.astro';
import MapEmbed from '~/components/widgets/MapEmbed.astro';
import Testimonials from '~/components/widgets/Testimonials.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';

const metadata = {
  title: 'B-Smart Learning Center',
  ignoreTitleTemplate: true,
};
---

<Layout metadata={metadata}>
  <!-- Hero Widget ******************* -->

  <Hero
    actions={[
      {
        variant: 'primary',
        text: 'Call Us',
        href: 'tel:+96181501832',
        icon: 'tabler:phone',
      },
      {
        variant: 'black',
        text: 'View Our Services',
        href: '/services',
      },

    ]}
  >
    <Fragment slot="bg">
      <div class="hero-background-container">
        <div class="hero-background-image"></div>
        <div class="hero-background-overlay"></div>
      </div>
    </Fragment>
    <Fragment slot="title">
      <div class="dynamic-text-container">
        <div class="dynamic-text-wrapper">
          <span class="dynamic-text" id="dynamicText">
            Tutoring That Delivers Real Results
          </span>
        </div>
        <div class="progress-dots-container">
          <button class="progress-dot active" data-index="0" aria-label="Go to phrase 1"></button>
          <button class="progress-dot" data-index="1" aria-label="Go to phrase 2"></button>
          <button class="progress-dot" data-index="2" aria-label="Go to phrase 3"></button>
          <button class="progress-dot" data-index="3" aria-label="Go to phrase 4"></button>
        </div>
      </div>
    </Fragment>
    

  </Hero>

  <!-- Scroll Indicator -->
  <div class="scroll-indicator">
    <div class="scroll-arrow">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 5v14M19 12l-7 7-7-7"/>
      </svg>
    </div>
    <span class="scroll-text">Scroll to Explore</span>
  </div>

  <style>
    /* Always transparent navbar on homepage - even when scrolled */
    #header,
    #header.scroll {
      background: transparent !important;
      border-bottom: 1px solid transparent !important;
    }
    /* Override scroll state background from tailwind.css */
    #header.scroll > div:first-child {
      background: transparent !important;
      backdrop-filter: none !important;
      box-shadow: none !important;
    }
    .dark #header.scroll > div:first-child {
      background: transparent !important;
      border-bottom: 1px solid transparent !important;
      box-shadow: none !important;
    }
    #header a, #header button {
      color: rgba(255, 255, 255, 0.95) !important;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    }
    #header img, #header span {
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
    }



    .hero-background-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      z-index: 0;
      will-change: transform;
    }

    .hero-background-image {
      position: absolute;
      top: -30%;
      left: -30%;
      width: 140%;
      height: 140%;
      background-image: url('/wave_light_mode.webp');
      background-size: cover;
      background-position: center center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      transform-origin: center center;
      filter: brightness(1) contrast(1.05) saturate(1.1);
      transition: filter 0.5s ease-in-out, background-image 0.5s ease-in-out;
      /* Faster, more dynamic animations */
      animation: bgFloat 12s ease-in-out infinite, bgWave 15s ease-in-out infinite;
      /* Use will-change only when animations are active */
      will-change: transform, background-position;
    }

    /* Horizontal drift animation - faster and more dynamic */
    @keyframes bgFloat {
      0%, 100% {
        background-position: 50% 50%;
      }
      25% {
        background-position: 46% 54%;
      }
      50% {
        background-position: 54% 46%;
      }
      75% {
        background-position: 46% 54%;
      }
    }

    /* Dynamic vertical wave motion with scale (breathing effect) */
    @keyframes bgWave {
      0%, 100% {
        transform: translateY(0) scale(1);
      }
      25% {
        transform: translateY(-1%) scale(1.02);
      }
      50% {
        transform: translateY(-2%) scale(1.04);
      }
      75% {
        transform: translateY(-1%) scale(1.02);
      }
    }


    /* Dark mode uses different image */
    html.dark .hero-background-image,
    .dark .hero-background-image {
      background-image: url('/wave.webp') !important;
      background-position: center 30%;
      filter: brightness(0.7) contrast(1.1) saturate(1.2);
      animation: bgFloatDark 12s ease-in-out infinite, bgWaveDark 15s ease-in-out infinite;
    }

    @keyframes bgFloatDark {
      0%, 100% {
        background-position: 50% 30%;
      }
      25% {
        background-position: 46% 34%;
      }
      50% {
        background-position: 54% 26%;
      }
      75% {
        background-position: 46% 34%;
      }
    }

    @keyframes bgWaveDark {
      0%, 100% {
        transform: translateY(0) scale(1);
      }
      25% {
        transform: translateY(-1%) scale(1.02);
      }
      50% {
        transform: translateY(-2%) scale(1.04);
      }
      75% {
        transform: translateY(-1%) scale(1.02);
      }
    }

    /* Subtle gradient overlay for text readability */
    .hero-background-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      /* Soft gradient with subtle vignette - reduced opacity for less blur */
      background: 
        radial-gradient(ellipse at center, transparent 0%, rgba(0, 0, 0, 0.05) 100%),
        linear-gradient(
          to bottom,
          rgba(255, 255, 255, 0.04) 0%,
          rgba(0, 0, 0, 0.08) 30%,
          rgba(0, 0, 0, 0.18) 70%,
          rgba(0, 0, 0, 0.28) 100%
        );
      z-index: 1;
      pointer-events: none;
      transition: background 0.5s ease-in-out;
    }

    /* Dark mode overlay - no white gradients */
    .dark .hero-background-overlay {
      background: none !important;
    }


    /* Add subtle animated gradient overlay for visual interest */
    .hero-background-overlay::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(
        ellipse at center,
        transparent 0%,
        rgba(0, 0, 0, 0.05) 100%
      );
      opacity: 0.4;
      animation: pulse 8s ease-in-out infinite;
    }

    .dark .hero-background-overlay::before {
      display: none;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 0.4;
        transform: scale(1);
      }
      50% {
        opacity: 0.5;
        transform: scale(1.05);
      }
    }

    /* Ensure hero section has proper height and positioning */
    section[class*="relative"] {
      min-height: 100vh;
      position: relative;
    }

    /* Add smooth theme transition */
    .hero-background-image,
    .hero-background-overlay {
      transition: filter 0.5s ease-in-out, background 0.5s ease-in-out;
    }

    /* Accessibility: Respect reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
      .hero-background-image {
        background-attachment: scroll;
        transform: none !important;
        filter: brightness(1) contrast(1) saturate(1);
        animation: none !important;
        will-change: auto;
      }
      .hero-background-container {
        position: absolute;
      }
      .hero-background-overlay::before {
        animation: none;
      }
      html.dark .hero-background-image,
      .dark .hero-background-image {
        background-image: url('/wave.webp') !important;
        filter: brightness(0.8) contrast(1) saturate(1);
        animation: none !important;
      }
    }

    /* Mobile optimization: enhanced for attractive, smooth design */
    @media (max-width: 1023px) {
      /* Mobile styles match desktop for consistency */
      .hero-background-image {
        top: -30%;
        left: -30%;
        width: 140%;
        height: 140%;
        background-attachment: fixed;
        background-position: center center;
        filter: brightness(1) contrast(1.05) saturate(1.1);
        animation: bgFloat 12s ease-in-out infinite, bgWave 15s ease-in-out infinite;
      }
      
      .hero-background-container {
        position: fixed;
        height: 100vh;
      }
      
      /* Use same overlay as desktop - reduced opacity for less blur */
      .hero-background-overlay {
        background: 
          radial-gradient(ellipse at center, transparent 0%, rgba(0, 0, 0, 0.05) 100%),
          linear-gradient(
            to bottom,
            rgba(255, 255, 255, 0.04) 0%,
            rgba(0, 0, 0, 0.08) 30%,
            rgba(0, 0, 0, 0.18) 70%,
            rgba(0, 0, 0, 0.28) 100%
          );
      }
      
      .dark .hero-background-overlay {
        background: none !important;
      }
      
      /* Dark mode - match desktop */
      html.dark .hero-background-image,
      .dark .hero-background-image {
        background-position: center 30%;
        filter: brightness(0.7) contrast(1.1) saturate(1.2);
        animation: bgFloatDark 12s ease-in-out infinite, bgWaveDark 15s ease-in-out infinite;
      }
    }

    /* Ultra-wide display support */
    @media (min-width: 1920px) {
      .hero-background-image {
        width: 150%;
        height: 150%;
        top: -25%;
        left: -25%;
      }
    }

    /* Smooth scrolling for the entire page */
    html {
      scroll-behavior: smooth;
    }

    /* Enhance text readability in both modes */
    section[class*="relative"] h1,
    section[class*="relative"] p {
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    .dark section[class*="relative"] h1,
    .dark section[class*="relative"] p {
      text-shadow: 0 2px 15px rgba(0, 0, 0, 0.5);
    }

    /* Mobile text shadow adjustments for better readability */
    @media (max-width: 768px) {
      section[class*="relative"] h1,
      section[class*="relative"] p {
        text-shadow: 0 1px 8px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .dark section[class*="relative"] h1,
      .dark section[class*="relative"] p {
        text-shadow: 0 1px 12px rgba(0, 0, 0, 0.6), 0 2px 6px rgba(0, 0, 0, 0.3);
      }
    }

    /* Scroll Indicator - Mobile optimized */
    .scroll-indicator {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 20;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      opacity: 1;
      transition: opacity 0.5s ease-out;
      pointer-events: none;
    }

    .scroll-indicator.fade-out {
      opacity: 0;
    }

    .scroll-arrow {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: rgba(255, 255, 255, 0.95);
      animation: bounce 2s infinite;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.4));
    }

    .scroll-text {
      color: rgba(255, 255, 255, 0.9);
      font-size: 0.75rem;
      font-weight: 500;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
      letter-spacing: 0.05em;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% {
        transform: translateY(0);
      }
      40% {
        transform: translateY(-8px);
      }
      60% {
        transform: translateY(-4px);
      }
    }

    /* Hide on desktop, show only on mobile */
    @media (min-width: 1024px) {
      .scroll-indicator {
        display: none;
      }
    }

    @media (max-width: 1024px) {
      .scroll-indicator {
        bottom: 25px;
      }
      
      .scroll-arrow {
        width: 28px;
        height: 28px;
      }
      
      .scroll-text {
        font-size: 0.7rem;
      }
    }

    /* Dynamic Text Rotation Styles */
    .dynamic-text-container {
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
    }

    .dynamic-text-wrapper {
      position: relative;
      min-height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1.5rem;
    }

    .dynamic-text-container h1 {
      margin: 0 !important;
      padding: 0 !important;
      background: none !important;
      -webkit-background-clip: unset !important;
      -webkit-text-fill-color: unset !important;
      background-clip: unset !important;
      color: unset !important;
    }

    .light .dynamic-text {
      display: block;
      font-size: 2.5rem !important;
      font-weight: 700 !important;
      line-height: 1.2 !important;
      text-align: center;
      margin: 0;
      padding: 0 1rem;
background: linear-gradient(135deg, #ffffff 0%, #e0f2fe 50%, #bae6fd 100%) !important;      
-webkit-background-clip: text !important;
      -webkit-text-fill-color: transparent !important;
      background-clip: text !important;
      background-size: 200% 200% !important;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1), 
                  transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      position: absolute;
      width: 100%;
    }

    .dynamic-text.active {
      opacity: 1;
      transform: translateY(0);
      position: relative;
      animation: shimmer 3s ease-in-out infinite;
    }

    .dark .dynamic-text.active {
      animation: shimmer 3s ease-in-out infinite;
    }

    @keyframes shimmer {
      0%, 100% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
    }

    .dark .dynamic-text {
      background: linear-gradient(135deg, #ffffff 0%, #e0f2fe 50%, #bae6fd 100%) !important;      -webkit-background-clip: text !important;
      -webkit-text-fill-color: transparent !important;
      background-clip: text !important;
      background-size: 200% 200% !important;
      
    }

    /* Progress Dots */
    .progress-dots-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      margin: 1.5rem auto 0;
      padding: 0.5rem;
    }

     .progress-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
  border-color: rgb(255, 255, 255) !important;
  background: rgb(255, 255, 255) !important;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      padding: 0;
      outline: none;
      position: relative;
    }

    .progress-dot:hover {
      transform: scale(1.5);
      border-color: rgba(15, 23, 42, 0.5);
      background: rgba(15, 23, 42, 0.3);
    }

    .progress-dot.active {
      width: 32px;
      height: 12px;
      border-radius: 6px;
      background: linear-gradient(90deg, #0a0e27 0%, #1a1f3a 25%, #2d3550 50%, #3d4a6b 75%, #4a5a7f 100%);
      background-size: 200% 100%;
      animation: shimmer-dot 3s ease-in-out infinite;
      border-color: transparent;
      box-shadow: 0 0 15px rgba(26, 31, 58, 0.6), 
                  0 0 30px rgba(26, 31, 58, 0.4), 
                  0 0 45px rgba(26, 31, 58, 0.2),
                  0 2px 8px rgba(0, 0, 0, 0.2);
    }

    @keyframes shimmer-dot {
      0%, 100% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
    }

    .progress-dot.active:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(26, 31, 58, 0.7), 
                  0 0 40px rgba(26, 31, 58, 0.5), 
                  0 0 60px rgba(26, 31, 58, 0.3),
                  0 2px 8px rgba(0, 0, 0, 0.2);
    }

  
/* Dark mode progress dots - make inactive dots more visible */
.dark .progress-dot {
  border-color: rgba(255, 255, 255, 0.6) !important;
  background: rgba(255, 255, 255, 0.4) !important;
}

.dark .progress-dot:hover {
  border-color: rgba(255, 255, 255, 0.8) !important;
  background: rgba(255, 255, 255, 0.5) !important;
}

.dark .progress-dot.active {
  background: linear-gradient(90deg, #f8fafc 0%, #f1f5f9 25%, #e2e8f0 50%, #cbd5e1 75%, #94a3b8 100%);
  background-size: 200% 100%;
  animation: shimmer-dot 3s ease-in-out infinite;
  box-shadow: 0 0 15px rgba(248, 250, 252, 0.6), 
              0 0 30px rgba(248, 250, 252, 0.4), 
              0 0 45px rgba(248, 250, 252, 0.3),
              0 2px 8px rgba(0, 0, 0, 0.3);
}

.dark .progress-dot.active:hover {
  box-shadow: 0 0 20px rgba(248, 250, 252, 0.7), 
              0 0 40px rgba(248, 250, 252, 0.5), 
              0 0 60px rgba(248, 250, 252, 0.4),
              0 2px 8px rgba(0, 0, 0, 0.3);
}

    /* Responsive adjustments */
    @media (max-width: 1024px) {
      .dynamic-text {
        font-size: 2rem !important;
      }
    }

    @media (max-width: 768px) {
      .dynamic-text {
        font-size: 1.75rem !important;
      }
      
      .dynamic-text-wrapper {
        min-height: 100px;
      }
    }

    @media (max-width: 480px) {
      .dynamic-text {
        font-size: 1.5rem !important;
      }
      
      .dynamic-text-wrapper {
        min-height: 80px;
      }
    }
  </style>

  <script is:inline>
    (function() {
      'use strict';
      
      // Dynamic Text Rotation with Dots
      (function() {
        const texts = [
          'Tutoring That Delivers Real Results',
          'Since 2017, we began in Jeb Jannine with just 3 students and 2 teachers.',
          'Today, B-Smart has assisted over 200+ students across the Beqaa region and employed 50+ teachers since its opening.',
          'We strive for excellence.'
        ];
        
        const textElement = document.getElementById('dynamicText');
        const dots = document.querySelectorAll('.progress-dot');
        let currentIndex = 0;
        let textChangeTimeout = null;
        let isUserControlled = false;
        
        if (!textElement || dots.length === 0) return;
        
        // Initialize first text and dot
        textElement.textContent = texts[0];
        textElement.classList.add('active');
        updateDots(0);
        
        function updateDots(activeIndex) {
          dots.forEach((dot, index) => {
            if (index === activeIndex) {
              dot.classList.add('active');
            } else {
              dot.classList.remove('active');
            }
          });
        }
        
        function changeText(newIndex = null) {
          // Clear any pending timeout
          if (textChangeTimeout) {
            clearTimeout(textChangeTimeout);
            textChangeTimeout = null;
          }
          
          // Determine next index
          if (newIndex !== null) {
            currentIndex = newIndex;
            isUserControlled = true;
          } else {
            currentIndex = (currentIndex + 1) % texts.length;
            isUserControlled = false;
          }
          
          // Fade out current text
          textElement.classList.remove('active');
          
          setTimeout(() => {
            // Update text
            textElement.textContent = texts[currentIndex];
            
            // Update dots
            updateDots(currentIndex);
            
            // Fade in new text
            setTimeout(() => {
              textElement.classList.add('active');
            }, 50);
            
            // Schedule next automatic change (only if not user controlled)
            if (!isUserControlled) {
              textChangeTimeout = setTimeout(() => {
                isUserControlled = false;
                changeText();
              }, 5000);
            } else {
              // If user clicked, wait 5 seconds then continue auto-rotation
              textChangeTimeout = setTimeout(() => {
                isUserControlled = false;
                changeText();
              }, 5000);
            }
          }, 400); // Wait for fade out
        }
        
        // Add click handlers to dots
        dots.forEach((dot, index) => {
          dot.addEventListener('click', () => {
            if (index !== currentIndex) {
              changeText(index);
            }
          });
        });
        
        // Start automatic rotation after 5 seconds
        textChangeTimeout = setTimeout(() => {
          changeText();
        }, 5000);
        
        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
          if (textChangeTimeout) clearTimeout(textChangeTimeout);
        });
      })();
      
      // Check for reduced motion preference
      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (prefersReducedMotion) return;

      let heroBg = null;
      let heroContainer = null;
      let heroSection = null;
      let isMobile = window.innerWidth <= 768;
      let ticking = false;
      let lastScrollY = 0;
      let mouseX = 0;
      let mouseY = 0;
      let currentX = 0;
      let currentY = 0;
      let rafId = null;

      function updateBackgroundImage() {
        if (!heroBg) return;
        const isDark = document.documentElement.classList.contains('dark');
        if (isDark) {
          heroBg.style.backgroundImage = "url('/wave.webp')";
        } else {
          heroBg.style.backgroundImage = "url('/wave_light_mode.webp')";
        }
      }

      function init() {
        heroBg = document.querySelector('.hero-background-image');
        heroContainer = document.querySelector('.hero-background-container');
        heroSection = document.querySelector('section[class*="relative"]');
        
        if (!heroBg || !heroContainer) return;

        // Set initial background image based on theme
        updateBackgroundImage();

        // Watch for theme changes
        const observer = new MutationObserver(() => {
          updateBackgroundImage();
        });
        observer.observe(document.documentElement, {
          attributes: true,
          attributeFilter: ['class']
        });

        // Detect device type (mobile/tablet vs desktop)
        function detectDeviceType() {
          const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
          const isSmallScreen = window.innerWidth <= 768;
          const hasFinePointer = window.matchMedia('(pointer: fine)').matches;
          
          isMobile = isTouchDevice || isSmallScreen || !hasFinePointer;
          return isMobile;
        }

        // Handle window resize - mobile matches desktop for consistency
        function handleResize() {
          detectDeviceType();
          // Use fixed positioning for both mobile and desktop for consistency
          heroContainer.style.position = 'fixed';
          heroBg.style.backgroundAttachment = 'fixed';
          heroBg.style.willChange = 'transform, background-position';
        }
        window.addEventListener('resize', handleResize, { passive: true });
        detectDeviceType();
        handleResize();

        // Highly sensitive mouse parallax effect - responds to slightest movement
        const hasMouse = window.matchMedia('(pointer: fine)').matches;
        const isTouchOnly = window.matchMedia('(pointer: coarse)').matches && !hasMouse;
        
        if (!isMobile && hasMouse && !isTouchOnly) {
          document.addEventListener('mousemove', (e) => {
            // Calculate mouse position relative to center
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const deltaX = e.clientX - centerX;
            const deltaY = e.clientY - centerY;
            
            // Highly sensitive: even small movements create visible effect
            // Increased multiplier for more responsive movement
            mouseX = (deltaX / centerX) * 40;
            mouseY = (deltaY / centerY) * 40;
          }, { passive: true });

          // Return to center smoothly when mouse leaves
          document.addEventListener('mouseleave', () => {
            mouseX = 0;
            mouseY = 0;
          }, { passive: true });
        }

        // Enhanced smooth parallax animation - consistent for mobile and desktop
        function animateMouseParallax() {
          if (!heroBg) {
            rafId = requestAnimationFrame(animateMouseParallax);
            return;
          }

          const scrollY = window.scrollY;
          const heroHeight = heroSection ? heroSection.offsetHeight : window.innerHeight;
          
          // Only apply parallax when in viewport
          if (scrollY < heroHeight) {
            // Scroll parallax: background moves slower than content (same for mobile and desktop)
            const scrollParallax = scrollY * 0.4;
            
            if (isMobile) {
              // Mobile: scroll parallax only (no mouse tracking)
              heroBg.style.transform = `translateY(${scrollParallax}px)`;
            } else {
              // Desktop: combine mouse and scroll parallax
              currentX += (mouseX - currentX) * 0.25;
              currentY += (mouseY - currentY) * 0.25;
              
              // Calculate dynamic scale based on mouse distance from center
              const mouseDistance = Math.sqrt(mouseX * mouseX + mouseY * mouseY);
              const dynamicScale = 1.15 + (mouseDistance / 80) * 0.06;
              
              // Add rotation based on mouse X position for depth
              const rotation = mouseX * 0.04;
              
              // Combine mouse, scroll parallax, rotation, and dynamic scale
              heroBg.style.transform = `translate(${currentX}px, ${currentY + scrollParallax}px) rotate(${rotation}deg) scale(${dynamicScale})`;
              
              // More sensitive background position shift - responds to slightest movement
              const bgX = (currentX / 40) * 3;
              const bgY = (currentY / 40) * 3;
              heroBg.style.backgroundPosition = `calc(50% + ${bgX}%) calc(50% + ${bgY}%)`;
            }
          }
          
          rafId = requestAnimationFrame(animateMouseParallax);
        }
        animateMouseParallax();

        // Scroll parallax effect
        function updateParallax() {
          if (!heroBg || !heroSection) return;

          const scrollY = window.scrollY;
          const heroHeight = heroSection.offsetHeight;
          const windowHeight = window.innerHeight;
          
          // Only apply parallax when hero section is in view
          // Mobile and desktop use same behavior for consistency
          if (scrollY < heroHeight + windowHeight) {
            // Parallax is handled in animateMouseParallax for both mobile and desktop
            // This ensures consistent behavior across all screen sizes
          }
          
          ticking = false;
        }

        function handleScroll() {
          if (!ticking) {
            window.requestAnimationFrame(updateParallax);
            ticking = true;
          }
        }

        window.addEventListener('scroll', handleScroll, { passive: true });
        
        // Initial call
        updateParallax();
      }

      // Initialize when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }

      // Cleanup on page unload
      window.addEventListener('beforeunload', () => {
        if (rafId) {
          cancelAnimationFrame(rafId);
        }
      });

      // Scroll indicator fade on scroll
      function handleScrollIndicator() {
        const scrollIndicator = document.querySelector('.scroll-indicator');
        if (!scrollIndicator) return;
        
        if (window.scrollY > 100) {
          scrollIndicator.classList.add('fade-out');
        } else {
          scrollIndicator.classList.remove('fade-out');
        }
      }
      
      window.addEventListener('scroll', handleScrollIndicator, { passive: true });
    })();
  </script>

  <!-- Services Section *************** -->

  <Features2
    id="services"
    tagline="Our Services"
    title="Comprehensive Tutoring Solutions"
    subtitle="From core subjects to specialized exam preparation, we offer personalized support to help every student succeed."
    columns={2}
    items={[
      {
        title: 'School Tutoring',
        description:
          'Expert support in Math, Physics, and Chemistry. Our tutors work with students to build strong foundations and improve grades through personalized learning plans.',
        icon: 'tabler:school',
      },
      {
        title: 'Exam Preparation',
        description:
          'Comprehensive preparation for SAT and official exams. We provide targeted strategies, practice tests, and confidence-building sessions to maximize your performance.',
        icon: 'tabler:certificate',
      },
      {
        title: 'Coding & Technology',
        description:
          'Learn Python and programming basics from experienced instructors. Perfect for students interested in technology and computer science careers.',
        icon: 'tabler:code',
      },
      {
        title: 'Languages',
        description:
          'English language support for students at all levels. Improve your communication skills, grammar, and vocabulary with our expert language tutors.',
        icon: 'tabler:language',
      },
    ]}
  />

  <!-- Why B-Smart Section ************ -->

  <Features
    id="why-bsmart"
    tagline="Why B-Smart"
    title="What Makes Us Different"
    subtitle="We're committed to providing exceptional educational support that adapts to each student's unique learning style and goals."
    items={[
      {
        title: 'Experienced Tutors',
        description:
          'Our team consists of qualified educators with years of experience in their respective subjects. They understand how to make complex topics accessible and engaging.',
        icon: 'tabler:user-star',
      },
      {
        title: 'Personalized Learning Plans',
        description:
          'Every student receives a customized learning plan tailored to their strengths, weaknesses, and academic goals. No one-size-fits-all approach here.',
        icon: 'tabler:target',
      },
      {
        title: 'Small Groups & 1-on-1 Sessions',
        description:
          'Choose from intimate small group sessions for collaborative learning or one-on-one tutoring for focused, individualized attention.',
        icon: 'tabler:users-group',
      },
      {
        title: 'Proven Student Improvement',
        description:
          'Our methods have helped hundreds of students improve their grades, build confidence, and achieve their academic goals. Results speak for themselves.',
        icon: 'tabler:chart-line',
      },
    ]}
  />

  <!-- Stats Widget ****************** -->

  <Stats
    stats={[
      { title: 'Students Taught', amount: '200+' },
      { title: 'Years of Experience', amount: '9' },
      { title: 'Success Rate', amount: '95%' },
      { title: 'Subjects Offered', amount: '12+' },
    ]}
  />

  <!-- Map Embed Widget ************** -->

  <MapEmbed
    id="location"
    title="Find Us"
    subtitle="Visit B-Smart Learning Center in Jebjannine."
  />

  <!-- CallToAction Widget *********** -->

  <CallToAction
    actions={[
      {
        variant: 'primary',
        text: 'Call Us',
        href: 'tel:+96181501832',
        icon: 'tabler:phone',
      },
      {
        variant: 'outline',
        text: 'Contact via WhatsApp',
        href: 'https://wa.me/96181501832',
        target: '_blank',
        icon: 'tabler:brand-whatsapp',
      },
    ]}
  >
    <Fragment slot="title">
      Ready to Start Your Learning Journey?
    </Fragment>

    <Fragment slot="subtitle">
      Call us today at +961 81 501 832 and discover how B-Smart can help you or your child achieve academic success.
      <br class="hidden md:inline" />
      Contact us via WhatsApp or phone for immediate assistance.
    </Fragment>
  </CallToAction>
</Layout>

